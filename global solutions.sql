SELECT cl.EnodebSectBandGrp AS UniqueID, s.SolutionID, s.SOLUTIONINITIATIVE, s.DSS, s.PARENTSOLUTIONID, IFNULL(s.SolutionName, '-') SolutionName, IFNULL(s.AUTODETECTED, 0) AUTODETECTED, COALESCE(s.SOLUTION_CATEGORY, s.SolutionType) AS SolutionType, s.SOLUTIONTYPE AS TYPE,  ON_AIR_YEAR_AUTO_NEW(IFNULL(s.PORY, 0), IFNULL(p.BUILDPLANYEAR, 0), 0, IFNULL(s.REQUESTED_YEAR, 0), IFNULL(s.STATUS, '')) OnAirYear , IFNULL(Status, '-') Status, IFNULL(CAST(s.PORY AS SIGNED), 0) POR, IFNULL(Disabled, 0) Disabled, IFNULL(OffloadPrediction, 1) OffloadPrediction, IFNULL(CAST(Bw700 AS SIGNED), 0) Bw700, IFNULL(CAST(BwAWS AS SIGNED), 0) BwAWS, IFNULL(CAST(BwPCS AS SIGNED), 0) BwPCS, IFNULL(CAST(Bw850 AS SIGNED), 0) Bw850, IFNULL(CAST(BwAWS3 AS SIGNED), 0) BwAWS3, IFNULL(CAST(BWCBAND AS SIGNED), 0) BwCBAND, IFNULL(CAST((CASE WHEN OFFLOADPREDICTION = 0 THEN OFFLOADPREDICTED ELSE OFFLOADPERCENT END) AS DECIMAL(4,2)), 0) Offload, IFNULL(CAST(SiteLatitude AS DECIMAL(8,5)), 0) Latitude, IFNULL(CAST(SiteLongitude AS DECIMAL(8,5)), 0) Longitude, IFNULL(s.ProjectNumber, 0) ProjectNumber, IFNULL(ProjectName, '-') ProjectName, IFNULL(cl.PSLC, 0) AS PSLC, IFNULL(DATE_FORMAT(CompletedOn, '%m/%d/%Y'), '-') CompletedOn, s.SOURCE, USEBUILDPLANYEAR, USEEXHAUSTEDYEAR, p.BUILDPLANYEAR, (SELECT MIN(PROJECTEDYEAR) FROM SOLUTION_PRIORITY E WHERE TRG = 1 AND s.SOLUTIONID = E.SOLUTIONID) AS EXHAUSTYEAR, s.TECHNOLOGY_TYPE, m.SECTOR_COUNT, cl.ENODEBGRP, cl.SECT, cl.ENODEBSECTBANDGRPLOGIC FROM SOLUTION s JOIN  SOLUTION_SITE_OFFLOAD_N5L  d ON s.SolutionID = d.SolutionID JOIN CARRIER_LOCATION_N5L cl ON d.AGG_UNIQUEID = cl.AGG_UNIQUEID LEFT JOIN MAX_OFFLOAD_SECTOR_COUNT m ON d.ENODEBSECT = m.ENODEBSECT AND d.FuzeSiteID = m.FuzeSiteID AND s.SOLUTIONID = m.SOLUTIONID LEFT JOIN FUZE_PROJECTS p ON s.ProjectNumber = p.ProjectNumber LEFT JOIN SOLUTION_TEMPLATE t ON (s.SOLUTIONTYPE = 'MODIFICATION' AND s.SOLUTIONINITIATIVE = t.SOLUTIONTYPE) OR (s.SOLUTIONTYPE != 'MODIFICATION' AND s.SOLUTIONTYPE = t.SOLUTIONTYPE) WHERE s.DELETED = 0 AND s.DISABLED = 0 AND s.AUTODETECTED = 0  AND UPPER(s.STATUS) IN ('ACTIVE','ON_HOLD','PENDING')   AND cl.ENODEBSECTGRP  IN ( '0560001-103', '0560001-102', '0560001-104', '0560001-10', '0560001-11', '0560001-109', '0560001-108', '0560001-110', '0560001-101', '0560001-100' )   AND s.RELEASE_FLAG  IN ( 'Yes' )  ORDER BY OnAirYear, Priority, s.PARENTSOLUTIONID, s.SOLUTIONID